{"version":3,"file":"favorites.js","sources":["../src/js/favorites-filter.js"],"sourcesContent":["// === SVG sprite helper (kalp, yıldız vb. için)\nconst SPRITE_PATH = './img/icons.svg';\nfunction svgIcon(name, className = '') {\n  const ref = `${SPRITE_PATH}#icon-${name}`;\n  return `<svg class=\"icon ${className}\" aria-hidden=\"true\" focusable=\"false\">\n    <use href=\"${ref}\" xlink:href=\"${ref}\"></use>\n  </svg>`;\n}\n\n/* ===== Category: solda container iç çizgisi, sağda viewport kenarı ===== */\nfunction alignCategoryToViewportRight() {\n  const wrapper = document.querySelector('.category-wrapper');\n  if (!wrapper) return;\n\n  const container =\n    wrapper.closest('.container') ||\n    document.querySelector('.favorites-filter .container') ||\n    document.querySelector('.container');\n  if (!container) return;\n\n  const vw = window.innerWidth;\n  const rect = container.getBoundingClientRect();\n  const cs = window.getComputedStyle(container);\n  const pl = parseFloat(cs.paddingLeft) || 0;\n\n  let startX = rect.left + pl;\n  let width = vw - startX;\n\n  startX = Math.max(0, Math.round(startX));\n  width = Math.max(0, Math.round(width));\n\n  wrapper.style.marginLeft = '0';\n  wrapper.style.marginRight = '0';\n  wrapper.style.maxWidth = 'none';\n\n  wrapper.style.width = `${width}px`;\n  wrapper.style.boxSizing = 'border-box';\n  wrapper.style.position = 'relative';\n  wrapper.style.transform = `translateX(${startX}px)`;\n}\n\n// Debounce\nlet __alignTimer;\nfunction __reqAlign() {\n  clearTimeout(__alignTimer);\n  __alignTimer = setTimeout(alignCategoryToViewportRight, 80);\n}\nwindow.addEventListener('load', alignCategoryToViewportRight);\nwindow.addEventListener('resize', __reqAlign);\n\n/* ===== Cross-tab publish (index.html & favorites.html arası) ===== */\nconst favBC =\n  'BroadcastChannel' in window ? new BroadcastChannel('favorites') : null;\nfunction broadcastFavoritesChange() {\n  window.dispatchEvent(new Event('favorites:updated'));\n  if (favBC) favBC.postMessage({ type: 'favorites:updated', at: Date.now() });\n  try {\n    if (typeof window.renderAll === 'function') window.renderAll();\n  } catch {}\n}\n\n/* === localStorage helpers === */\nfunction getFavoritesLS() {\n  try {\n    const v = JSON.parse(localStorage.getItem('favorites'));\n    return Array.isArray(v) ? v : [];\n  } catch {\n    return [];\n  }\n}\nfunction setFavoritesLS(arr) {\n  localStorage.setItem('favorites', JSON.stringify(arr || []));\n  broadcastFavoritesChange();\n}\nfunction getRecipeIdSafe(r) {\n  return r?._id || r?.id;\n}\n\nconst esc = s =>\n  (s ?? '').toString().replace(\n    /[&<>\"']/g,\n    m =>\n      ({\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': '&quot;',\n        \"'\": '&#39;',\n      }[m])\n  );\n\n// === Yıldızlar\nfunction getStarIcons(rating = 0, { max = 5, fillEmpty = false } = {}) {\n  const full = Math.max(0, Math.min(max, Math.floor(Number(rating) || 0)));\n  const filled = Array.from({ length: full })\n    .map(() => svgIcon('Star', 'star-icon'))\n    .join('');\n  if (!fillEmpty) return filled;\n\n  const empty = Math.max(0, max - full);\n  const empties = Array.from({ length: empty })\n    .map(() => svgIcon('Star-empty', 'star-icon empty'))\n    .join('');\n  return `${filled}${empties}`;\n}\n\n// === Sayfalama yardımcıları\nfunction getRecipesPerPage() {\n  const w = window.innerWidth;\n  if (w < 768) return 9;\n  if (w < 1280) return 12;\n  return 12;\n}\nfunction getPaginationRange(current, total) {\n  if (total <= 2) return [1, total];\n  if (current >= total - 1) return [total - 1, total];\n  if (current <= 1) return [1, 2];\n  return [current, current + 1];\n}\n\n/* ==== State ==== */\nconst state = {\n  currentPage: 1,\n  currentCategory: 'All',\n  recipesPerPage: getRecipesPerPage(),\n  isLoading: false,\n};\n\nwindow.addEventListener('resize', () => {\n  state.recipesPerPage = getRecipesPerPage();\n  renderAll();\n});\n\nfunction computeCategories(items) {\n  return [\n    ...new Set(\n      (items || []).map(\n        r => r?.category?.name || r?.category || 'Uncategorized'\n      )\n    ),\n  ];\n}\n\n/* ==== DOM refs ==== */\nconst favoritesListEl = document.getElementById('favorites-list');\nconst emptyMessageEl = document.getElementById('empty-message');\nconst categoryListEl = document.getElementById('category-list');\nconst allBtn = document.getElementById('all-categories-btn');\nconst categoryWrapperEl = document.querySelector('.category-wrapper');\n\n/* LOADING elemanı */\nlet loadingEl = null;\nfunction ensureLoadingEl() {\n  if (!loadingEl) {\n    loadingEl = document.createElement('div');\n    loadingEl.id = 'loading-message';\n    loadingEl.textContent = 'Loading…';\n    loadingEl.style.textAlign = 'center';\n    loadingEl.style.margin = '24px auto';\n    loadingEl.style.fontWeight = '600';\n    loadingEl.style.opacity = '0.8';\n    favoritesListEl?.insertAdjacentElement('beforebegin', loadingEl);\n  }\n  return loadingEl;\n}\nfunction showLoading() {\n  state.isLoading = true;\n  ensureLoadingEl().style.display = 'block';\n  emptyMessageEl?.classList.add('hidden');\n  const p = getPaginationEl();\n  if (p) p.style.display = 'none';\n  if (favoritesListEl) favoritesListEl.innerHTML = '';\n  if (categoryWrapperEl) categoryWrapperEl.style.display = 'none';\n}\nfunction hideLoading() {\n  state.isLoading = false;\n  if (loadingEl) loadingEl.style.display = 'none';\n}\n\nfunction getPaginationEl() {\n  let el = document.getElementById('pagination-container');\n  if (!el) el = document.querySelector('.pagination');\n  return el;\n}\n\nfunction ensureBaseRefs() {\n  return favoritesListEl && emptyMessageEl && categoryListEl && allBtn;\n}\n\n/* ==== Category buttons ==== */\nfunction renderCategories(items) {\n  if (!ensureBaseRefs()) return;\n\n  if (!items || items.length === 0) {\n    if (categoryWrapperEl) categoryWrapperEl.style.display = 'none';\n    categoryListEl.innerHTML = '';\n    if (allBtn) allBtn.classList.remove('active');\n    return;\n  } else {\n    if (categoryWrapperEl) categoryWrapperEl.style.display = '';\n  }\n\n  categoryListEl.innerHTML = '';\n\n  const setActiveClasses = () => {\n    document\n      .querySelectorAll('.category')\n      .forEach(b => b.classList.remove('active'));\n    if (state.currentCategory === 'All') allBtn.classList.add('active');\n    else allBtn.classList.remove('active');\n  };\n\n  allBtn.onclick = () => {\n    state.currentCategory = 'All';\n    state.currentPage = 1;\n    setActiveClasses();\n    renderCards();\n  };\n\n  computeCategories(items).forEach(cat => {\n    const btn = document.createElement('button');\n    btn.className = 'category';\n    btn.textContent = cat;\n    if (cat === state.currentCategory) btn.classList.add('active');\n    btn.addEventListener('click', () => {\n      state.currentCategory = cat;\n      state.currentPage = 1;\n      setActiveClasses();\n      btn.classList.add('active');\n      renderCards();\n    });\n    categoryListEl.appendChild(btn);\n  });\n\n  setActiveClasses();\n  alignCategoryToViewportRight();\n}\n\n/* ==== Pagination (yalnızca sayıları ve enable/disable'ı yönetir) ==== */\nfunction renderPagination(totalPages) {\n  const container = getPaginationEl();\n  if (!container) return;\n\n  if (!Number.isFinite(totalPages) || totalPages <= 1) {\n    container.style.display = 'none';\n    return;\n  }\n  container.style.display = 'flex';\n\n  const btnFirst = container.querySelector('.page-icon.first');\n  const btnPrev = container.querySelector('.page-icon.prev');\n  const btnNext = container.querySelector('.page-icon.next');\n  const btnLast = container.querySelector('.page-icon.last');\n  const numbersWrap = container.querySelector('.page-numbers');\n\n  const atFirst = state.currentPage === 1;\n  const atLast = state.currentPage === totalPages;\n  if (btnFirst) btnFirst.disabled = atFirst;\n  if (btnPrev) btnPrev.disabled = atFirst;\n  if (btnNext) btnNext.disabled = atLast;\n  if (btnLast) btnLast.disabled = atLast;\n\n  const [start, end] = getPaginationRange(state.currentPage, totalPages);\n  const frag = document.createDocumentFragment();\n\n  if (start > 1) {\n    const dotsL = document.createElement('button');\n    dotsL.className = 'dots';\n    dotsL.textContent = '…';\n    dotsL.disabled = true;\n    frag.appendChild(dotsL);\n  }\n\n  for (let i = start; i <= end; i++) {\n    const b = document.createElement('button');\n    b.type = 'button';\n    b.textContent = String(i);\n    if (i === state.currentPage) b.classList.add('active');\n    b.addEventListener('click', () => {\n      if (state.currentPage !== i) {\n        state.currentPage = i;\n        renderCards();\n      }\n    });\n    frag.appendChild(b);\n  }\n\n  if (end < totalPages) {\n    const dotsR = document.createElement('button');\n    dotsR.className = 'dots';\n    dotsR.textContent = '…';\n    dotsR.disabled = true;\n    frag.appendChild(dotsR);\n  }\n\n  if (numbersWrap) {\n    numbersWrap.innerHTML = '';\n    numbersWrap.appendChild(frag);\n  }\n\n  if (btnFirst)\n    btnFirst.onclick = () => {\n      if (!btnFirst.disabled) {\n        state.currentPage = 1;\n        renderCards();\n      }\n    };\n  if (btnPrev)\n    btnPrev.onclick = () => {\n      if (!btnPrev.disabled) {\n        state.currentPage = Math.max(1, state.currentPage - 1);\n        renderCards();\n      }\n    };\n  if (btnNext)\n    btnNext.onclick = () => {\n      if (!btnNext.disabled) {\n        state.currentPage = Math.min(totalPages, state.currentPage + 1);\n        renderCards();\n      }\n    };\n  if (btnLast)\n    btnLast.onclick = () => {\n      if (!btnLast.disabled) {\n        state.currentPage = totalPages;\n        renderCards();\n      }\n    };\n}\n\n/* ==== Cards ==== */\nfunction renderCards() {\n  if (!ensureBaseRefs()) return;\n\n  if (state.isLoading) {\n    const p = getPaginationEl();\n    if (p) p.style.display = 'none';\n    favoritesListEl.innerHTML = '';\n    emptyMessageEl.classList.add('hidden');\n    return;\n  }\n\n  const favoriteRecipes = getFavoritesLS();\n  const paginationEl = getPaginationEl();\n\n  // Boş liste → mesajı göster, pagination gizle, kategori barını gizle\n  if (!favoriteRecipes || favoriteRecipes.length === 0) {\n    favoritesListEl.innerHTML = '';\n    emptyMessageEl.classList.remove('hidden');\n    if (paginationEl) paginationEl.style.display = 'none';\n    if (categoryWrapperEl) categoryWrapperEl.style.display = 'none';\n    return;\n  }\n  emptyMessageEl.classList.add('hidden');\n\n  // Kategori filtresi\n  const filtered =\n    state.currentCategory === 'All'\n      ? favoriteRecipes\n      : favoriteRecipes.filter(\n          r =>\n            (r?.category?.name || r?.category || 'Uncategorized') ===\n            state.currentCategory\n        );\n\n  if (filtered.length === 0) {\n    favoritesListEl.innerHTML = `<p style=\"text-align:center;\">No recipes in this category.</p>`;\n    if (paginationEl) paginationEl.style.display = 'none';\n    // veri var ama bu kategoride yok → kategori barı görünür kalmalı\n    if (categoryWrapperEl) categoryWrapperEl.style.display = '';\n    return;\n  }\n\n  // Sayfalama\n  const totalPages = Math.max(\n    1,\n    Math.ceil(filtered.length / state.recipesPerPage)\n  );\n  if (state.currentPage > totalPages) state.currentPage = totalPages;\n  const start = (state.currentPage - 1) * state.recipesPerPage;\n  const currentItems = filtered.slice(start, start + state.recipesPerPage);\n\n  // Kartlar\n  favoritesListEl.innerHTML = '';\n  currentItems.forEach(recipe => {\n    const card = document.createElement('div');\n    card.className = 'recipe-card';\n    const bg = recipe.preview || recipe.thumb || recipe.image_url || '';\n    card.style.backgroundImage = bg ? `url('${bg}')` : 'none';\n\n    card.innerHTML = `\n      <div class=\"recipe-overlay\"></div>\n      <div class=\"heart\" data-id=\"${getRecipeIdSafe(recipe) ?? ''}\">\n        ${svgIcon('heart')}\n      </div>\n      <div class=\"recipe-card-content\">\n        <h4>${esc(recipe.title)}</h4>\n        <p>${esc(recipe.description || 'Açıklama bulunamadı.')}</p>\n        <div class=\"recipe-meta\">\n          <span class=\"star-group\">\n            ${Number(recipe.rating ?? 0).toFixed(2)}\n            <span class=\"star-icon\">\n              ${getStarIcons(recipe.rating)}\n            </span>\n          </span>\n          <button class=\"secondary-button see-recipe-btn\">See recipe</button>\n        </div>\n      </div>\n    `;\n\n    const heartEl = card.querySelector('.heart');\n    if (heartEl) {\n      heartEl.addEventListener('click', () => {\n        const rid = String(getRecipeIdSafe(recipe));\n        const all = getFavoritesLS();\n        const idx = all.findIndex(r => String(getRecipeIdSafe(r)) === rid);\n        if (idx !== -1) {\n          all.splice(idx, 1);\n          setFavoritesLS(all); // setFavoritesLS → broadcastFavoritesChange()\n        }\n      });\n    }\n\n    const seeBtn = card.querySelector('.see-recipe-btn');\n    if (seeBtn) {\n      seeBtn.addEventListener('click', () => {\n        if (typeof window.openPopup === 'function') {\n          window.openPopup(recipe);\n        } else {\n          console.error(\n            '❌ window.openPopup bulunamadı. popup_menu.js yüklendi mi?'\n          );\n        }\n      });\n    }\n\n    favoritesListEl.appendChild(card);\n  });\n\n  if (categoryWrapperEl) categoryWrapperEl.style.display = '';\n\n  // pagination’ı sadece 1’den büyükse göster\n  renderPagination(totalPages);\n\n  // Kartlar sonrası hizalamayı yinele (kategori yüksekliği değişebilir)\n  alignCategoryToViewportRight();\n}\n\n/* ==== Hepsini render eden ==== */\nfunction renderAll() {\n  const items = getFavoritesLS();\n  renderCategories(items); // burada boşsa kategori barı gizlenir\n  renderCards();\n}\n// Popup'tan doğrudan çağrı için global'e bağla\nwindow.renderAll = renderAll;\n\n/* ==== Açılış ==== */\nwindow.addEventListener('load', () => {\n  if (!ensureBaseRefs()) {\n    console.warn('⚠️ Gerekli DOM elemanları bulunamadı.');\n    return;\n  }\n\n  // İlk anda loading göster\n  showLoading();\n  renderCards(); // loading görünürken listeyi temizler (kategori barı da gizli)\n\n  // favorites henüz yazılmamış olabilir (main.js asenkron)\n  let tries = 0;\n  const t = setInterval(() => {\n    const hasData = getFavoritesLS().length > 0;\n    tries++;\n\n    if (hasData || tries > 10) {\n      clearInterval(t);\n      hideLoading();\n      renderAll(); // veri varsa listele, yoksa boş mesaj + kategori gizli\n      alignCategoryToViewportRight();\n    }\n  }, 500);\n});\n\n// localStorage başka tab/pencereden veya popup’tan güncellenirse\nwindow.addEventListener('storage', e => {\n  if (e.key === 'favorites') {\n    hideLoading();\n    renderAll();\n    alignCategoryToViewportRight();\n  }\n});\nwindow.addEventListener('favorites:updated', () => {\n  hideLoading();\n  renderAll();\n  alignCategoryToViewportRight();\n});\n// BroadcastChannel’dan gelen mesajlar\nif (favBC) {\n  favBC.onmessage = ev => {\n    if (ev.data?.type === 'favorites:updated') {\n      hideLoading();\n      renderAll();\n      alignCategoryToViewportRight();\n    }\n  };\n}\n"],"names":["SPRITE_PATH","svgIcon","name","className","ref","alignCategoryToViewportRight","wrapper","container","vw","rect","cs","pl","startX","width","__alignTimer","__reqAlign","favBC","broadcastFavoritesChange","getFavoritesLS","v","setFavoritesLS","arr","getRecipeIdSafe","r","esc","s","m","getStarIcons","rating","max","fillEmpty","full","filled","empty","empties","getRecipesPerPage","w","getPaginationRange","current","total","state","renderAll","computeCategories","items","_a","favoritesListEl","emptyMessageEl","categoryListEl","allBtn","categoryWrapperEl","loadingEl","ensureLoadingEl","showLoading","p","getPaginationEl","hideLoading","el","ensureBaseRefs","renderCategories","setActiveClasses","b","renderCards","cat","btn","renderPagination","totalPages","btnFirst","btnPrev","btnNext","btnLast","numbersWrap","atFirst","atLast","start","end","frag","dotsL","i","dotsR","favoriteRecipes","paginationEl","filtered","currentItems","recipe","card","bg","heartEl","rid","all","idx","seeBtn","tries","hasData","ev"],"mappings":"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"}